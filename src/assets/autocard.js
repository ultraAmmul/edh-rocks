!function(){(function(){"use strict";var t=new function(){},e=new Set("annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" "));function n(t){var n=e.has(t);return t=/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(t),!n&&t}function r(t){var e=t.isConnected;if(void 0!==e)return e;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function o(t,e){for(;e&&e!==t&&!e.nextSibling;)e=e.parentNode;return e&&e!==t?e.nextSibling:null}function i(t,e,n){n=n||new Set;for(var r=t;r;){if(r.nodeType===Node.ELEMENT_NODE){var a=r;e(a);var s=a.localName;if("link"===s&&"import"===a.getAttribute("rel")){if((r=a.import)instanceof Node&&!n.has(r))for(n.add(r),r=r.firstChild;r;r=r.nextSibling)i(r,e,n);r=o(t,a);continue}if("template"===s){r=o(t,a);continue}if(a=a.__CE_shadowRoot)for(a=a.firstChild;a;a=a.nextSibling)i(a,e,n)}r=r.firstChild?r.firstChild:o(t,r)}}function a(t,e,n){t[e]=n}function s(){this.a=new Map,this.o=new Map,this.f=[],this.b=!1}function c(t,e){t.b=!0,t.f.push(e)}function l(t,e){t.b&&i(e,function(e){return d(t,e)})}function d(t,e){if(t.b&&!e.__CE_patched){e.__CE_patched=!0;for(var n=0;n<t.f.length;n++)t.f[n](e)}}function u(t,e){var n=[];for(i(e,function(t){return n.push(t)}),e=0;e<n.length;e++){var r=n[e];1===r.__CE_state?t.connectedCallback(r):f(t,r)}}function h(t,e){var n=[];for(i(e,function(t){return n.push(t)}),e=0;e<n.length;e++){var r=n[e];1===r.__CE_state&&t.disconnectedCallback(r)}}function p(t,e,n){var r=(n=n||{}).w||new Set,o=n.s||function(e){return f(t,e)},a=[];if(i(e,function(e){if("link"===e.localName&&"import"===e.getAttribute("rel")){var n=e.import;n instanceof Node&&(n.__CE_isImportDocument=!0,n.__CE_hasRegistry=!0),n&&"complete"===n.readyState?n.__CE_documentLoadHandled=!0:e.addEventListener("load",function(){var n=e.import;if(!n.__CE_documentLoadHandled){n.__CE_documentLoadHandled=!0;var i=new Set(r);i.delete(n),p(t,n,{w:i,s:o})}})}else a.push(e)},r),t.b)for(e=0;e<a.length;e++)d(t,a[e]);for(e=0;e<a.length;e++)o(a[e])}function f(t,e){if(void 0===e.__CE_state){var n=e.ownerDocument;if((n.defaultView||n.__CE_isImportDocument&&n.__CE_hasRegistry)&&(n=t.a.get(e.localName))){n.constructionStack.push(e);var o=n.constructor;try{try{if(new o!==e)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{n.constructionStack.pop()}}catch(s){throw e.__CE_state=2,s}if(e.__CE_state=1,e.__CE_definition=n,n.attributeChangedCallback)for(n=n.observedAttributes,o=0;o<n.length;o++){var i=n[o],a=e.getAttribute(i);null!==a&&t.attributeChangedCallback(e,i,null,a,null)}r(e)&&t.connectedCallback(e)}}}function m(t,e){this.c=t,this.a=e,this.b=void 0,p(this.c,this.a),"loading"===this.a.readyState&&(this.b=new MutationObserver(this.f.bind(this)),this.b.observe(this.a,{childList:!0,subtree:!0}))}function g(t){t.b&&t.b.disconnect()}function y(){var t=this;this.b=this.a=void 0,this.f=new Promise(function(e){t.b=e,t.a&&e(t.a)})}function C(t){if(t.a)throw Error("Already resolved.");t.a=void 0,t.b&&t.b(void 0)}function b(t){this.i=!1,this.c=t,this.m=new Map,this.j=function(t){return t()},this.g=!1,this.l=[],this.u=new m(t,document)}s.prototype.connectedCallback=function(t){var e=t.__CE_definition;e.connectedCallback&&e.connectedCallback.call(t)},s.prototype.disconnectedCallback=function(t){var e=t.__CE_definition;e.disconnectedCallback&&e.disconnectedCallback.call(t)},s.prototype.attributeChangedCallback=function(t,e,n,r,o){var i=t.__CE_definition;i.attributeChangedCallback&&-1<i.observedAttributes.indexOf(e)&&i.attributeChangedCallback.call(t,e,n,r,o)},m.prototype.f=function(t){var e=this.a.readyState;for("interactive"!==e&&"complete"!==e||g(this),e=0;e<t.length;e++)for(var n=t[e].addedNodes,r=0;r<n.length;r++)p(this.c,n[r])},b.prototype.define=function(t,e){var r,o,i,a,s,c=this;if(!(e instanceof Function))throw new TypeError("Custom element constructors must be functions.");if(!n(t))throw new SyntaxError("The element name '"+t+"' is not valid.");if(this.c.a.get(t))throw Error("A custom element with name '"+t+"' has already been defined.");if(this.i)throw Error("A custom element is already being defined.");this.i=!0;try{var l=function(t){var e=d[t];if(void 0!==e&&!(e instanceof Function))throw Error("The '"+t+"' callback must be a function.");return e},d=e.prototype;if(!(d instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");r=l("connectedCallback"),o=l("disconnectedCallback"),i=l("adoptedCallback"),a=l("attributeChangedCallback"),s=e.observedAttributes||[]}catch(u){return}finally{this.i=!1}e={localName:t,constructor:e,connectedCallback:r,disconnectedCallback:o,adoptedCallback:i,attributeChangedCallback:a,observedAttributes:s,constructionStack:[]},function(t,e,n){t.a.set(e,n),t.o.set(n.constructor,n)}(this.c,t,e),this.l.push(e),this.g||(this.g=!0,this.j(function(){return function(t){if(!1!==t.g){t.g=!1;for(var e=t.l,n=[],r=new Map,o=0;o<e.length;o++)r.set(e[o].localName,[]);for(p(t.c,document,{s:function(e){if(void 0===e.__CE_state){var o=e.localName,i=r.get(o);i?i.push(e):t.c.a.get(o)&&n.push(e)}}}),o=0;o<n.length;o++)f(t.c,n[o]);for(;0<e.length;){o=(i=e.shift()).localName;for(var i=r.get(i.localName),a=0;a<i.length;a++)f(t.c,i[a]);(o=t.m.get(o))&&C(o)}}}(c)}))},b.prototype.get=function(t){if(t=this.c.a.get(t))return t.constructor},b.prototype.whenDefined=function(t){if(!n(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var e=this.m.get(t);return e?e.f:(e=new y,this.m.set(t,e),this.c.a.get(t)&&!this.l.some(function(e){return e.localName===t})&&C(e),e.f)},b.prototype.v=function(t){g(this.u);var e=this.j;this.j=function(n){return t(function(){return e(n)})}},window.CustomElementRegistry=b,b.prototype.define=b.prototype.define,b.prototype.get=b.prototype.get,b.prototype.whenDefined=b.prototype.whenDefined,b.prototype.polyfillWrapFlushCallback=b.prototype.v;var w=window.Document.prototype.createElement,E=window.Document.prototype.createElementNS,v=window.Document.prototype.importNode,_=window.Document.prototype.prepend,k=window.Document.prototype.append,T=window.DocumentFragment.prototype.prepend,N=window.DocumentFragment.prototype.append,x=window.Node.prototype.cloneNode,A=window.Node.prototype.appendChild,L=window.Node.prototype.insertBefore,D=window.Node.prototype.removeChild,M=window.Node.prototype.replaceChild,S=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),I=window.Element.prototype.attachShadow,H=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),O=window.Element.prototype.getAttribute,j=window.Element.prototype.setAttribute,P=window.Element.prototype.removeAttribute,F=window.Element.prototype.getAttributeNS,$=window.Element.prototype.setAttributeNS,z=window.Element.prototype.removeAttributeNS,R=window.Element.prototype.insertAdjacentElement,B=window.Element.prototype.insertAdjacentHTML,U=window.Element.prototype.prepend,q=window.Element.prototype.append,G=window.Element.prototype.before,W=window.Element.prototype.after,Y=window.Element.prototype.replaceWith,V=window.Element.prototype.remove,X=window.HTMLElement,Q=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),J=window.HTMLElement.prototype.insertAdjacentElement,K=window.HTMLElement.prototype.insertAdjacentHTML;function Z(t,e,n){function o(e){return function(n){for(var o=[],i=0;i<arguments.length;++i)o[i-0]=arguments[i];i=[];for(var a=[],s=0;s<o.length;s++){var c=o[s];if(c instanceof Element&&r(c)&&a.push(c),c instanceof DocumentFragment)for(c=c.firstChild;c;c=c.nextSibling)i.push(c);else i.push(c)}for(e.apply(this,o),o=0;o<a.length;o++)h(t,a[o]);if(r(this))for(o=0;o<i.length;o++)(a=i[o])instanceof Element&&u(t,a)}}n.h&&(e.prepend=o(n.h)),n.append&&(e.append=o(n.append))}var tt,et=window.customElements;if(!et||et.forcePolyfill||"function"!=typeof et.define||"function"!=typeof et.get){var nt=new s;tt=nt,window.HTMLElement=function(){function e(){var e=this.constructor;if(!(r=tt.o.get(e)))throw Error("The custom element being constructed was not registered with `customElements`.");var n=r.constructionStack;if(!n.length)return n=w.call(document,r.localName),Object.setPrototypeOf(n,e.prototype),n.__CE_state=1,n.__CE_definition=r,d(tt,n),n;var r,o=n[r=n.length-1];if(o===t)throw Error("The HTMLElement constructor was either called reentrantly for this constructor or called multiple times.");return n[r]=t,Object.setPrototypeOf(o,e.prototype),d(tt,o),o}return e.prototype=X.prototype,e}(),function(){var t=nt;a(Document.prototype,"createElement",function(e){if(this.__CE_hasRegistry){var n=t.a.get(e);if(n)return new n.constructor}return e=w.call(this,e),d(t,e),e}),a(Document.prototype,"importNode",function(e,n){return e=v.call(this,e,n),this.__CE_hasRegistry?p(t,e):l(t,e),e}),a(Document.prototype,"createElementNS",function(e,n){if(this.__CE_hasRegistry&&(null===e||"http://www.w3.org/1999/xhtml"===e)){var r=t.a.get(n);if(r)return new r.constructor}return e=E.call(this,e,n),d(t,e),e}),Z(t,Document.prototype,{h:_,append:k})}(),Z(nt,DocumentFragment.prototype,{h:T,append:N}),function(){var t=nt;function e(e,n){Object.defineProperty(e,"textContent",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(e){if(this.nodeType===Node.TEXT_NODE)n.set.call(this,e);else{var o=void 0;if(this.firstChild){var i=this.childNodes,a=i.length;if(0<a&&r(this)){o=Array(a);for(var s=0;s<a;s++)o[s]=i[s]}}if(n.set.call(this,e),o)for(e=0;e<o.length;e++)h(t,o[e])}}})}a(Node.prototype,"insertBefore",function(e,n){if(e instanceof DocumentFragment){var o=Array.prototype.slice.apply(e.childNodes);if(e=L.call(this,e,n),r(this))for(n=0;n<o.length;n++)u(t,o[n]);return e}return o=r(e),n=L.call(this,e,n),o&&h(t,e),r(this)&&u(t,e),n}),a(Node.prototype,"appendChild",function(e){if(e instanceof DocumentFragment){var n=Array.prototype.slice.apply(e.childNodes);if(e=A.call(this,e),r(this))for(var o=0;o<n.length;o++)u(t,n[o]);return e}return n=r(e),o=A.call(this,e),n&&h(t,e),r(this)&&u(t,e),o}),a(Node.prototype,"cloneNode",function(e){return e=x.call(this,e),this.ownerDocument.__CE_hasRegistry?p(t,e):l(t,e),e}),a(Node.prototype,"removeChild",function(e){var n=r(e),o=D.call(this,e);return n&&h(t,e),o}),a(Node.prototype,"replaceChild",function(e,n){if(e instanceof DocumentFragment){var o=Array.prototype.slice.apply(e.childNodes);if(e=M.call(this,e,n),r(this))for(h(t,n),n=0;n<o.length;n++)u(t,o[n]);return e}o=r(e);var i=M.call(this,e,n),a=r(this);return a&&h(t,n),o&&h(t,e),a&&u(t,e),i}),S&&S.get?e(Node.prototype,S):c(t,function(t){e(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],e=0;e<this.childNodes.length;e++)t.push(this.childNodes[e].textContent);return t.join("")},set:function(t){for(;this.firstChild;)D.call(this,this.firstChild);A.call(this,document.createTextNode(t))}})})}(),function(){var t=nt;function e(e,n){Object.defineProperty(e,"innerHTML",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(e){var o=this,a=void 0;if(r(this)&&(a=[],i(this,function(t){t!==o&&a.push(t)})),n.set.call(this,e),a)for(var s=0;s<a.length;s++){var c=a[s];1===c.__CE_state&&t.disconnectedCallback(c)}return this.ownerDocument.__CE_hasRegistry?p(t,this):l(t,this),e}})}function n(e,n){a(e,"insertAdjacentElement",function(e,o){var i=r(o);return e=n.call(this,e,o),i&&h(t,o),r(e)&&u(t,o),e})}function o(e,n){function r(e,n){for(var r=[];e!==n;e=e.nextSibling)r.push(e);for(n=0;n<r.length;n++)p(t,r[n])}a(e,"insertAdjacentHTML",function(t,e){if("beforebegin"===(t=t.toLowerCase())){var o=this.previousSibling;n.call(this,t,e),r(o||this.parentNode.firstChild,this)}else if("afterbegin"===t)o=this.firstChild,n.call(this,t,e),r(this.firstChild,o);else if("beforeend"===t)o=this.lastChild,n.call(this,t,e),r(o||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");o=this.nextSibling,n.call(this,t,e),r(this.nextSibling,o)}})}I&&a(Element.prototype,"attachShadow",function(t){return this.__CE_shadowRoot=I.call(this,t)}),H&&H.get?e(Element.prototype,H):Q&&Q.get?e(HTMLElement.prototype,Q):c(t,function(t){e(t,{enumerable:!0,configurable:!0,get:function(){return x.call(this,!0).innerHTML},set:function(t){var e="template"===this.localName,n=e?this.content:this,r=w.call(document,this.localName);for(r.innerHTML=t;0<n.childNodes.length;)D.call(n,n.childNodes[0]);for(t=e?r.content:r;0<t.childNodes.length;)A.call(n,t.childNodes[0])}})}),a(Element.prototype,"setAttribute",function(e,n){if(1!==this.__CE_state)return j.call(this,e,n);var r=O.call(this,e);j.call(this,e,n),n=O.call(this,e),t.attributeChangedCallback(this,e,r,n,null)}),a(Element.prototype,"setAttributeNS",function(e,n,r){if(1!==this.__CE_state)return $.call(this,e,n,r);var o=F.call(this,e,n);$.call(this,e,n,r),r=F.call(this,e,n),t.attributeChangedCallback(this,n,o,r,e)}),a(Element.prototype,"removeAttribute",function(e){if(1!==this.__CE_state)return P.call(this,e);var n=O.call(this,e);P.call(this,e),null!==n&&t.attributeChangedCallback(this,e,n,null,null)}),a(Element.prototype,"removeAttributeNS",function(e,n){if(1!==this.__CE_state)return z.call(this,e,n);var r=F.call(this,e,n);z.call(this,e,n);var o=F.call(this,e,n);r!==o&&t.attributeChangedCallback(this,n,r,o,e)}),J?n(HTMLElement.prototype,J):R?n(Element.prototype,R):console.warn("Custom Elements: `Element#insertAdjacentElement` was not patched."),K?o(HTMLElement.prototype,K):B?o(Element.prototype,B):console.warn("Custom Elements: `Element#insertAdjacentHTML` was not patched."),Z(t,Element.prototype,{h:U,append:q}),function(t){var e=Element.prototype;function n(e){return function(n){for(var o=[],i=0;i<arguments.length;++i)o[i-0]=arguments[i];i=[];for(var a=[],s=0;s<o.length;s++){var c=o[s];if(c instanceof Element&&r(c)&&a.push(c),c instanceof DocumentFragment)for(c=c.firstChild;c;c=c.nextSibling)i.push(c);else i.push(c)}for(e.apply(this,o),o=0;o<a.length;o++)h(t,a[o]);if(r(this))for(o=0;o<i.length;o++)(a=i[o])instanceof Element&&u(t,a)}}G&&(e.before=n(G)),G&&(e.after=n(W)),Y&&a(e,"replaceWith",function(e){for(var n=[],o=0;o<arguments.length;++o)n[o-0]=arguments[o];o=[];for(var i=[],a=0;a<n.length;a++){var s=n[a];if(s instanceof Element&&r(s)&&i.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)o.push(s);else o.push(s)}for(a=r(this),Y.apply(this,n),n=0;n<i.length;n++)h(t,i[n]);if(a)for(h(t,this),n=0;n<o.length;n++)(i=o[n])instanceof Element&&u(t,i)}),V&&a(e,"remove",function(){var e=r(this);V.call(this),e&&h(t,this)})}(t)}(),document.__CE_hasRegistry=!0;var rt=new b(nt);Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:rt})}}).call(self);const t={gatherer:"gatherer",urzaCo:"urzaCo",scryfall:"scryfall",magicCardsInfo:"magicCardsInfo"},e={gatherer:"gatherer",comboDeck:"comboDeck",urzaCo:"urzaCo",scryfall:"scryfall",magicCardsInfo:"magicCardsInfo"},n=["magicCardsInfo"];var r={configAttrs:["imgSource","linkSource","language"],displayName:{gatherer:"Gatherer",comboDeck:"combodeck.net",urzaCo:"urza.co",scryfall:"scryfall.com"},displayUrls:{gatherer:"https://gatherer.wizards.com",comboDeck:"http://combodeck.net",urzaCo:"https://urza.co",scryfall:"https://scryfall.com"},imgSource:t,linkSource:e,partners:["comboDeck","urzaCo","scryfall"],imgSources:Object.keys(t).map(e=>t[e]).filter(t=>!n.includes(t)),linkSources:Object.keys(e).map(t=>e[t]).filter(t=>!n.includes(t))},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};const i={testImagePath:null,apiUrl:"https://mtgify.org",ignoreCase:!0,trimWhitespace:!0,excludeUnsets:!1,enableAutoTag:!1,popupAutoTag:!1,imgSource:r.imgSource.gatherer,linkSource:r.linkSource.gatherer,language:"en"};var a=t=>{const e=window.MTGIFY_CONFIG||{};return o({},i,e,t||{})},s={decompressArray:function(t){const e=t.key;return t.arr.map(t=>{const n={};return t.map((t,r)=>{n[e[r]]=t}),n})}},c=class{constructor(t,e){this.verifier=t,this.maxLength=e}tryReplaceText(t){const e=this.verifier(t);return null!==e?{ok:!0,newText:e}:{ok:!1}}replaceFirst(t){for(let e=0;e<t.length;e++){let n=e+Math.min(this.maxLength,t.length-e)+1,r="",o={ok:!1};for(;!o.ok&&n>e;)n-=1,r=t.substring(e,n),o=this.tryReplaceText(r);if(o.ok)return{changed:!0,newHTML:o.newText,beforeText:t.substring(0,e),afterText:t.substring(n)}}return{changed:!1}}},l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function d(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}class u{constructor(t){const e=this;e.lookupPromise=new Promise((t,n)=>{e.resolveLookup=((n,r)=>{const o=s.decompressArray(r),i=e.createLookup(n,o);t(i)})});const n=a(t);window.fetch(`${n.apiUrl}/json/version.json`,{cache:"no-store"}).then(t=>t.json()).then(t=>{const r=(t.date||(new Date).toISOString()).slice(0,10).split("-").join("");window.fetch(`${n.apiUrl}/json/CardInfo.compressed.json?v=${r}`).then(t=>t.json()).then(n=>e.resolveLookup(t,n))})}getVersion(){return this.lookupPromise.then(t=>t.version)}normalizeCardName(t,e){let n=t.toLowerCase();return n=(n=n.split("\u2019").join("'")).split("&#8217;").join("'"),e.trimWhitespace&&(n=n.trim()),n}performLookup(t,e,n){return t.cards[this.normalizeCardName(e,n)]||null}createLookup(t,e){const n=this,r=a(),o={};let i="",s="";return e.forEach(t=>{o[n.normalizeCardName(t.name,r)]=t,!t.isUn&&t.name.length>i.length&&(i=t.name),t.isUn&&t.name.length>s.length&&(s=t.name)}),{version:t,cards:o,longestName:i,longestUnName:s}}attachCardMetaData(t,e,n){if(null===e)return null;if(!n.ignoreCase&&t.trim()!==e.name.trim())return null;if(n.excludeUnsets&&e.isUn)return null;let o=null;switch(n.imgSource){case r.imgSource.magicCardsInfo:case r.imgSource.scryfall:o=`https://api.scryfall.com/cards/${e.setCode}/${e.cardNum}/${n.language}?format=image`;break;case r.imgSource.urzaCo:let t=d(e.cardNum,3);isNaN(t.slice(-1))&&(t=d(t,4)),o=`https://s3.urza.co/cards/${e.setCode}/front/200dpi/${t}.jpg`}return o||(o=`https://gatherer.wizards.com/Handlers/Image.ashx?multiverseid=${e.mid}&type=card`),o=n.testImagePath||o,l({},e,{imgUrl:o})}getCardInfo(t,e){const n=this,r=a(e);return n.lookupPromise.then(e=>n.performLookup(e,t,r)).then(e=>n.attachCardMetaData(t,e,r))}getRandomCard(t){const e=this,n=a(t);return n.ignoreCase=!0,e.lookupPromise.then(t=>{const r=Object.keys(t.cards);let o=null;for(;null===o;){const i=r[Math.floor(Math.random()*r.length)];o=e.performLookup(t,i,n),o=e.attachCardMetaData(i,o,n)}return o})}renderAutoCard(t,e){if(null===t)return null;const n=document.createElement("auto-card");return n.setAttribute("name",t.name),r.configAttrs.forEach(t=>{n.setAttribute(t,e[t])}),n}newTextParser(t){const e=this,n=a(t);return this.lookupPromise.then(t=>{const r=n.excludeUnsets?t.longestName.length:t.longestUnName.length;return new c(r=>{const o=e.performLookup(t,r,n),i=e.attachCardMetaData(r,o,n);return e.renderAutoCard(i,n)},r)})}}var h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};const p=["Land","Creature","Artifact","Enchantment","Planeswalker","Instant","Sorcery"].reverse(),f={Default:"deckList",Cuts:"cuts",Adds:"adds"},m="Commander",g="Uncategorized",y=[m,"Creature","Planeswalker","Artifact","Enchantment","Instant","Sorcery","Land",g],C=/\(\d+\)/,b=/^deck$/,w=/^cuts$/,E=/^adds$/,v=/^name (.+)/,_=/^info (.+)/,k=/^link ([^ ]+) (.+)/,T=/(.+) \*CMDR\*$/;class N{constructor(t,e,n){this.text=t,this.options=e,this.cardApi=n}parseData(){const{text:t,options:e,cardApi:n}=this,r={},o=[];let i=f.Default;return t.split("\n").forEach(t=>{const e=t.trim();if(0===e.length)return;if("#"===e[0]){const t=e.substring(1).trim(),n=v.exec(t);n&&(r.name=n[1]);const o=k.exec(t);o&&(r.link={url:o[1],label:o[2]});const a=_.exec(t);return a&&(r.info=a[1]),b.test(t)&&(i=f.Default),w.test(t)&&(i=f.Cuts),void(E.test(t)&&(i=f.Adds))}if(C.test(e))return;const a=e.indexOf("x "),s=parseInt(e.substring(0,a),10);let c=e.substring(a+2);const l=T.exec(c);l&&(c=l[1]);const d={deck:i},u=n.getCardInfo(c).then(t=>{let e=g;return t?p.forEach(n=>{t.types.includes(n)&&(e=n)}):t={name:c},l&&(e=m),h({},d,{quantity:s,type:e,card:t})});o.push(u)}),Promise.all(o).then(t=>({meta:r,cards:t}))}splitDecks(t){const e={};return t.forEach(t=>{e[t.deck]||(e[t.deck]=[]),e[t.deck].push(t)}),e}processData(t){let{meta:e,cards:n}=t;const{options:r}=this;r.reverse&&(n=n.reverse());const o=this.splitDecks(n),i={};for(let a in o)i[a]=this.categorizeDeck(o[a]);return h({meta:e},i)}getDataPromise(){return this.parseData().then(t=>this.processData(t))}categorizeDeck(t){const e={};t.forEach(t=>{null!==t&&(e[t.type]||(e[t.type]={type:t.type,cards:[],count:0}),e[t.type].cards.push(t),e[t.type].count+=t.quantity)});const n=[];return y.forEach(t=>{e[t]&&n.push(e[t])}),n}}var x,A=function(t,e,n){return fetch(t).then(t=>t.text()).then(t=>new N(t,e,n).getDataPromise())},L=function(t,e,n){return new N(t,e,n).getDataPromise()};const D=document.createElement("div");D.style="display: none; position: absolute;";let M=!1;const S=document.createElement("img");S.onerror="this.onerror=null;this.onmouseout=null;this.onmouseover=null;hideImgPopup();",S.width=223,S.height=310,D.appendChild(S),x={show:function(t,e){t.getCardInfo().then(n=>{n&&(M||(M=!0,document.body.appendChild(D)),D.setAttribute("data-mid",n.mid),D.style.top=`${function(t,e){const n=t.offsetHeight;let r=t.offsetTop+n,o=t;for(;null!=o.offsetParent;)r+=null==(o=o.offsetParent).offsetTop?0:o.offsetTop;return screen.height/2<e.clientY&&(r-=310+n),r}(t,e)}px`,D.style.left=`${function(t,e){let n=e.clientX+10;return document.body.offsetWidth/2<e.clientX&&(n-=243),n}(0,e)}px`,S.src="",S.src=n.imgUrl,D.style.display="block")})},hide:function(t,e){t.getCardInfo().then(t=>{t&&D.getAttribute("data-mid")===String(t.mid)&&(D.style.display="none")})},move:function(t,e){}};var I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};class H{constructor(t){this.cardApi=t}tagBody(t){return this.tagElement(document.body,t)}tagElement(t,e){const n=I({ignoreCase:!1,excludeUnsets:!0},e=e||{});n.trimWhitespace=!1;const r=document.createElement("div");r.style="position: fixed; top: 5px; right: 5px; padding: 10px; background-color: #FFFFFF; color: #000000; border: 2px solid #000000; border-radius: 10px;",r.innerHTML="mtgify is searching for Magic cards...",n.popupAutoTag&&document.body.appendChild(r);const o=this;return o.cardApi.newTextParser(n).then(e=>(o._searchElement(e,t),"todo")).then(t=>(o._teardown_popup(r),t)).catch(t=>{o._teardown_popup(r)})}_teardown_popup(t){t.innerHTML="mtgify is done!",setTimeout(()=>t.remove(),1e3)}_searchElement(t,e){if(e.hasAttribute&&e.hasAttribute("auto-card-off"))return;if(e.tagName&&e.tagName.toLowerCase().includes("auto-card"))return;const n=this;if(e.nodeType===Node.TEXT_NODE){const r=e.textContent;if(r){const o=t.replaceFirst(r);if(o.changed){const r=e.nextSibling,i=document.createTextNode(o.beforeText);e.parentNode.insertBefore(i,r),e.parentNode.insertBefore(o.newHTML,r);const a=document.createTextNode(o.afterText);e.parentNode.insertBefore(a,r),e.remove(),n._searchElement(t,a)}}}else for(var r=0;r<e.childNodes.length;r++){const o=e.childNodes[r];n._searchElement(t,o)}return""}}const O=a(),j=(()=>new u)(),P=((t=>{let e=0;class n extends HTMLElement{connectedCallback(){const t=this.textContent;if(this.setAttribute("data-autocard-id",e++),this.onInitTextListener(),t)this.textContent="",this.handleInnerText(t);else{const t=this,e=function(e){const n=e[0].addedNodes[0];n&&"#text"===n.nodeName&&(t._observer.disconnect(),n.remove(),t.handleInnerText(n.textContent))};t._observer=new MutationObserver(e),t._observer.observe(t,{childList:!0})}}uuid(){return this.getAttribute("data-autocard-id")}queryOther(t){return document.querySelector(`*[data-autocard-id="${t}"`)}onInitTextListener(){}handleInnerText(t){}}class o extends n{onInitTextListener(){this.anchor=document.createElement("a"),this.anchor.setAttribute("target","_blank");const t=this.getAttribute("name");t&&this.loadCardByName(t)}handleInnerText(t){this.customText=t,this.cardName?this.loadCardByName(this.cardName):this.loadCardByName(t)}loadCardByName(t){this.cardName=t.trim(),this.innerHTML="",this.appendChild(this.anchor),this.getCardLink().then(t=>{t&&this.anchor.setAttribute("href",t)});let e=void 0!==this.customText?this.customText:this.cardName;const n=this.getAttribute("quantity");n&&(e=`${n}x ${e}`),this.anchor.innerHTML=e,this.onInitAutoCard()}getConfig(){const t={},e=this;return r.configAttrs.forEach(n=>{e.hasAttribute(n)&&(t[n]=e.getAttribute(n))}),a(t)}getCardLink(){return this.getCardInfo().then(t=>{if(!t)return;const{name:e,mid:n}=t;switch(this.getConfig().linkSource){case r.linkSource.magicCardsInfo:case r.linkSource.scryfall:return String.raw`https://scryfall.com/search?q=name:/(?<=\/\/ |^)${e}(?= \/\/|$)/`;case r.linkSource.comboDeck:return"http://combodeck.net/Query/"+e;case r.linkSource.urzaCo:return"https://urza.co/m/cards?q="+e;default:return"https://gatherer.wizards.com/Pages/Card/Details.aspx?multiverseid="+n}})}getCardInfo(){return t.getCardInfo(this.cardName,this.getConfig())}onInitAutoCard(){}}class i extends o{onInitAutoCard(){const t=this;t.getCardInfo().then(e=>t.loadCardImage(e))}loadCardImage(t){if(!t)return;const e=document.createElement("img");e.setAttribute("src",t.imgUrl),e.setAttribute("alt",t.name),e.setAttribute("title",t.name),this.anchor.innerHTML="",this.anchor.appendChild(e),this.image=e;const n=parseInt(this.getAttribute("quantity")||"1",10);if(n>1){const t=document.createElement("auto-card-image-quantity");t.innerHTML="x"+n,this.anchor.appendChild(t)}}}function s(t,e){void 0===customElements.get(t)&&customElements.define(t,e)}s("auto-card",class extends o{onInitAutoCard(){this.onmouseover=(t=>this.onMouseOver(t)),this.onmouseout=(t=>this.onMouseOut(t)),this.imagePreviewId=this.getAttribute("data-preview");const t=this.getPreview();t&&t.loadDefault(this)}getPreview(){const{imagePreviewId:t}=this;return t?this.queryOther(t):null}getImageController(){return this.getPreview()||x}onMouseOver(t){this.getImageController().show(this,t)}onMouseOut(t){this.getImageController().hide(this,t)}}),s("auto-card-image",i),s("auto-card-image-quantity",class extends HTMLElement{}),s("auto-card-list",class extends n{onInitTextListener(){this.collapsed=!0,this.canCollapse=this.hasAttribute("collapse"),this.listToggle=document.createElement("auto-card-list-toggle"),this.listToggle.addListener(t=>this.toggle(t),this.collapsed),this.listToggleContainer=document.createElement("auto-card-list-head"),this.listToggleContainer.appendChild(this.listToggle),this.deckOptions={};const e=this.getAttribute("src");e&&this.loadDeckData(A(e,this.deckOptions,t))}handleInnerText(e){this.deckDataPromise||this.loadDeckData(L(e,this.deckOptions,t))}loadDeckData(t){this.deckDataPromise=t,this.render()}toggle(t){this.collapsed=t,this.render()}render(){const t=this;t.innerHTML="loading deck list...",t.deckDataPromise.then(e=>{t.innerHTML="",t.renderHead(e),t.renderBody(e)})}renderHead(t){const{meta:e}=t,n=this.getAttribute("name")||e.name,r=this.getAttribute("info")||e.info,o=this.getAttribute("link")||e.link,i=document.createElement("auto-card-list-head");if(n){const t=document.createElement("auto-card-list-name");i.appendChild(t),t.innerHTML=n}if(r){const t=document.createElement("auto-card-list-info");i.appendChild(t),t.innerHTML=`${r}`}if(o){const t=document.createElement("auto-card-list-link");i.appendChild(t),t.innerHTML=`<a href="${o.url}">${o.label}</a>`}(n||r||o)&&this.appendChild(i)}renderBody(t){const{cuts:e,adds:n,deckList:r}=t,o=e||n;if(o){const t=document.createElement("auto-card-list-diff");this.renderDecklist(e,t,"Cuts",!1),this.renderDecklist(n,t,"Adds",!1),this.appendChild(t)}this.canCollapse&&this.appendChild(this.listToggleContainer);const i=this.canCollapse&&this.collapsed;r&&!i&&this.renderDecklist(r,this,o&&"Deck List",!0)}renderDecklist(t,e,n,r){const o=document.createElement("auto-card-list-body");if(e.appendChild(o),n){const t=document.createElement("auto-card-list-head"),e=document.createElement("auto-card-list-name");t.appendChild(e),o.appendChild(t),e.innerHTML=n}const i=this;if(i.hasAttribute("showImages")){const e=document.createElement("auto-card-list-image-container");t.forEach(t=>{t.cards.forEach(t=>{const n=document.createElement("auto-card-image");e.appendChild(n),i.applyConfig(n,t)})}),o.appendChild(e)}else{const e=document.createElement("auto-card-list-text-container");o.appendChild(e);const n=r&&i.hasAttribute("preview")&&document.createElement("auto-card-list-preview");n&&(e.appendChild(n),n.setAttribute("imgSource",i.getAttribute("imgSource")),n.setAttribute("linkSource",i.getAttribute("linkSource"))),t.forEach(t=>{const r=document.createElement("auto-card-list-category"),o=document.createElement("auto-card-list-category-type");o.innerHTML=`${t.type} (${t.count})`,r.appendChild(o),t.cards.forEach(t=>{const e=document.createElement("auto-card");r.appendChild(e),i.applyConfig(e,t),n&&e.setAttribute("data-preview",n.uuid())}),e.appendChild(r)})}}applyConfig(t,e){t.setAttribute("name",e.card.name),t.setAttribute("quantity",e.quantity),t.setAttribute("imgSource",this.getAttribute("imgSource")),t.setAttribute("linkSource",this.getAttribute("linkSource"))}}),s("auto-card-list-head",class extends HTMLElement{}),s("auto-card-list-toggle",class extends HTMLElement{addListener(t,e){if(!this.callback){const t=this;t.addEventListener("click",()=>t.onClick())}this.state=e,this.callback=(()=>t(this.state)),this.render()}onClick(){this.state=!this.state,this.render(),this.callback()}render(){this.innerHTML=this.state?"(expand)":"(hide)"}}),s("auto-card-list-name",class extends HTMLElement{}),s("auto-card-list-info",class extends HTMLElement{}),s("auto-card-list-link",class extends HTMLElement{}),s("auto-card-list-diff",class extends HTMLElement{}),s("auto-card-list-body",class extends HTMLElement{}),s("auto-card-list-preview",class extends i{loadDefault(t){this.cardName||this.loadCardByName(t.cardName)}show(t,e){this.loadCardByName(t.cardName)}hide(t,e){}}),s("auto-card-list-category",class extends HTMLElement{}),s("auto-card-list-category-type",class extends HTMLElement{}),s("auto-card-list-text-container",class extends HTMLElement{}),s("auto-card-list-image-container",class extends HTMLElement{})})(j),(t=>new H(t))(j));window.MTGIFY_CONFIG=window.MTGIFY_CONFIG||{},window.MTGIFY={_cardApi:j,constants:r,config:window.MTGIFY_CONFIG,getVersion:t=>j.getVersion(t),getRandomCard:t=>j.getRandomCard(t),tagBody:t=>P.tagBody(t),tagElement:(t,e)=>P.tagElement(t,e)},setTimeout(()=>{O.enableAutoTag&&P.tagBody(O)})}();